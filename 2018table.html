<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>2018年VirMach闪购历史数据</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="static_pack/Bootstrap-4-4.1.1/css/bootstrap.min.css" rel="stylesheet" />
    <link href="static_pack/DataTables-1.10.20/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
    <script src="static_pack/jQuery-3.3.1/jquery-3.3.1.min.js"></script>
    <script src="static_pack/DataTables-1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="static_pack/DataTables-1.10.20/js/dataTables.bootstrap4.min.js"></script>

    <style>
        body {
            background: #2c3e50;
            background: -webkit-linear-gradient(to left, #2c3e50, #3498db);
            background: linear-gradient(to left, #2c3e50, #3498db);
        }

        .bg-dark {
            position: relative;
            min-height: 70px;
            z-index: 20;
            background-color: #2c3e50 !important;
            box-shadow: 0 5px 0 rgba(0,0,0,.2);
        }

        .footer {
            color: white;
            background: #222 !important;
            border: 1px solid rgba(34, 34, 34, 0.86) !important;
            padding: 15px 0px;
        }
        table th { 
		    text-align: center;
		    vertical-align: middle !important;
		}
	</style>
</head>
<body>
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
        <div class="nav navbar-header">
            <a class="navbar-brand" href="/">
                <span itemprop="name">VirMach</span>
            </a>
        </div>
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="/index.html">实时监控</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/2019.html">2019年数据</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="/2018.html">2018年数据</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">自动下单</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">留言板</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#">帮助</a>
            </li>
        </ul>
    </nav>

    <div class="card">
        <div class="card-body">
            <div class="col-sm-12 text-center">
            	<h1>2018年VirMach闪购历史数据</h1>
            </div>
            <div class="col-sm-12">
                <table id="example" class="table table-striped table-bordered" style="width:100%"></table>
            </div>
            <div class="col-sm-8">

            </div>
        </div>
    </div>


    <nav class="text-center footer" role="navigation">
        <p> 
            <img src="http://blog.0ddt.com/content/templates/red_zui/images/txy.png" width="80"> 
            <img src="http://blog.0ddt.com/content/templates/red_zui/images/360.png" width="80"> 
            <img src="http://blog.0ddt.com/content/templates/red_zui/images/aly.png" width="80"> 
            <img src="http://blog.0ddt.com/content/templates/red_zui/images/ypy.png" width="80"> 
            <img src="http://blog.0ddt.com/content/templates/red_zui/images/wxpay.png" width="80"> 
            <img src="http://blog.0ddt.com/content/templates/red_zui/images/zfb.png" width="80"> 
        </p>
            <hr style="background:#ffffff;margin:10px 50px;" />
            <p>Copyright © 2018-2020 段彤网络. All Rights Reserved</p>
    </nav>


    <script>

        $(document).ready(function () {
            $('#example').DataTable({
                //data: data,//为ajax的值,没有直接用插件自带的请求数据方式，个人data的方式好控制一些
                "ajax": '/api.php?y=2018', 
                createdRow: function( row, data, dataIndex ) {
	                $(row).children('td').attr('style', 'text-align: center;vertical-align: middle;');
	            },
                "columns": [
                    {
                        "data": "cpu",
                        "title": "CPU",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || '0'
                            return data + ' 核心';
                        }
                    },
                    {
                        "data": "ram",
                        "title": "内存",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || '0'
                            return data + ' MB';
                        }
                    },
                    {
                        "data": "hdd",
                        "title": "硬盘",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || '0'
                            return data + ' G';
                        }
                    },
                    {
                        "data": "bw",
                        "title": "月流量",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || '0'
                            return data + ' GB';
                        }
                    },
                    {
                        "data": "ips",
                        "title": "IP",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || '0'
                            return data + ' 个';
                        }
                    },
                    {
                        "data": "windows",
                        "title": "Windows",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || ' '
                            if("TRUE" === data){
                            	data = "✅";
                            }
                            return data;
                        }
                    },
                    {
                        "data": "location",
                        "title": "地区",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = Fg(data) || ''
                            return data;
                        }
                    },
                    {
                        "data": "message",
                        "title": "消息",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || ''
                            return data;
                        }
                    },
                    {
                        "data": "price",
                        "title": "价格",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data|| '$0'
                            return data.replace("\/yr", "");
                        }
                    },
                    {
                        "data": "datetime",
                        "title": "时间",
                        "searchable": true,
                        "render": function (data, type, full, meta) {
                            var data = data || ''
                            return data;
                        }
                    }
                ],
                columnDefs: [{
                        "title": "比价",
	                	"targets": 10,//自定义列的序号，从0开始
	                	"data": "price", //需要引用的数据列，一般是主键
	                	"render": function(data, type, full){
	                		var ram = 0.003828125, cpu = 5, hdd = 0.15, bw = 0.007, ip = 5;
	                		var r = (full.cpu * cpu) + (full.ram * ram) + (full.hdd * hdd) + (full.bw * bw) + (full.ips * ip);
	                        var temp = full.price || '$0';
	                        temp = temp.replace("\/yr", "");
	                        var t = ln(full);
	                        t = t.annotation || "<span style='color:#ddd!important'>不合适！</span>";
	                        return t;
	                	}
                }],
                "stateSave": true,
                "order": [ 9, 'desc' ],  //这行些不行效果都一样
                "pagingType": "simple_numbers",  //分页样式：simple,simple_numbers,full,full_numbers
                "bProcessing": true, //DataTables载入数据时，是否显示‘进度’提示
                "bAutoWidth": true, //是否自适应宽度 //"bScrollInfinite" : false, //是否启动初始化滚动条
                "bScrollCollapse": true, //是否开启DataTables的高度自适应，当数据条数不够分页数据条数的时候，插件高度是否随数据条数而改变
                oLanguage: {//多语言配置
                    "sProcessing": "正在加载中......",
                    "sLengthMenu": "每页显示 _MENU_ 条记录",
                    "sZeroRecords": "对不起，查询不到相关数据！",
                    "sEmptyTable": "表中无数据存在！",
                    "sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录",
                    "sInfoFiltered": "数据表中共为 _MAX_ 条记录",
                    "sSearchPlaceholder": "🔍 查找",//搜索框内占位符
                    "sSearch": "",//搜索框前的字体
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上一页",
                        "sNext": "下一页",
                        "sLast": "末页"
                    }
                },
                language: {
                    "sProcessing": "正在获取数据，请稍后...",
                    "sLengthMenu": "显示 _MENU_ 项结果",
                    "sZeroRecords": "没有匹配结果",
                    "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索:",
                    "sUrl": "",
                    "sEmptyTable": "表中数据为空",
                    "sLoadingRecords": "载入中...",
                    "sInfoThousands": ",",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上页",
                        "sNext": "下页",
                        "sLast": "末页"
                    },
                    "oAria": {
                        "sSortAscending": ": 以升序排列此列",
                        "sSortDescending": ": 以降序排列此列"
                    }
                }
            });
        });
        
		function ln(e) {
		    
	        if (!(e && e.virt && e.cpu && e.ram && e.hdd && e.bw && e.ips && e.price && e.location)){
	            return {};
	        }
	        var r = Number(e.price.match(/\d[\d.]*/)[0]);
	        if (!r)
	            return {};
	        var t = (5 * e.cpu + Number(e.ram) / 1024 * 3 + e.hdd * (5 - Math.log(e.hdd) / 2 / Math.log(4.5)) / 10 + 4 * (e.ips - 1)) / (e.virt.match(/KVM/i) ? 1 : 2);
	        
	        "TRUE" === e.windows && 
	        (t += Math.min(.15 * t, 6)),t *= 1.1,e.ram < 256 && 
	        (t *= .8),e.ram < 512 && 
	        (t *= .85),e.ram < 1024 && 
	        (t *= .9),e.hdd < 5 && 
	        (t *= .25),e.bw < 200 && 
	        (t *= .25);
	        
	        
	        var a = 100 - Math.floor(r / t * 100), l = "";
	        var l='';
	        if(a >= 65){
	            l="<span style='color:#e12248!important'>惊人折扣，快抢！</span>";
	        }else if(a >= 45){
	            l= "<span style='color:#e15c22!important'>绝对超值！</span>";
	        }else if(a >= 35){
	            l= "<span style='color:#e1bc22!important'>超值！</span>";
	        }else if(a >= 20){
	            l= "<span style='color:#22a8e1!important'>还行。</span>";
	        }else if(r <= 7){
	            l= "<span style='color:#64a016!important'>便宜货。</span>";
	        }else if(e.hdd >= 50){
	            l= "<span style='color:#64a016!important'>大硬盘。</span>";
	        }else if(e.bw >= 2048){
	            l= "<span style='color:#64a016!important'>大流量。</span>";
	        }else {
	            l= "无";
	        }
	        
	        
		  //  console.log(JSON.stringify(e)+' - '+ a)
	        
	        return !(l = a >= 65 ? "<span style='color:#e12248!important'>惊人折扣，快抢！</span>" : a >= 45 ? "<span style='color:#e15c22!important'>绝对超值！</span>" : a >= 35 ? "<span style='color:#e1bc22!important'>超值！</span>" : a >= 20 ? "<span style='color:#22a8e1!important'>还行。</span>" : "") && r <= 8.5 && (l = "<span style='color:#64a016!important'>便宜货。</span>"),
	        e.bw < 200 && (l = ""),
	        {
	            price: r,
	            percentOff: a,
	            value: t,
	            annotation: l
	        }
	    }
		
		function jc(e) {
	        return e && e.virt && e.cpu && e.ram && e.hdd && e.bw && e.ips && e.price && e.location
	    }
	    
	    function Fg(e) {
	        return e.replace(/Flashdeals/gi, "闪购页面").replace(/sold out/g, "已售罄").replace(/SWITCHING SOON/gi, "即将刷新").replace(/New offer in 15 seconds/gi, "15 秒后刷新").replace(/US English Female/gi, "Chinese Female").replace(/No Brainer!/gi, "惊人折扣，快抢！").replace(/Great Deal!/gi, "绝对超值！").replace(/Good Deal\./gi, "超值！").replace(/Not bad\./gi, "还行。").replace(/Cheap deal\./gi, "便宜货！").replace(/Monitor/gi, "监控").replace(/\/yr/gi, "/年").replace(/\/mo/gi, "/月").replace(/Auto\sUpdate/gi, "自动刷新").replace(/Sold\sOut/gi, "已售罄").replace(/Limited Offer/gi, "限时优惠").replace(/Available/gi, "可用").replace(/DEDICATED\sRAM/gi, "独立内存").replace(/RAM/gi, "内存").replace(/DEDICATED IPv4/gi, "独立 IP").replace(/FAIR\sSHARE/gi, "共享").replace(/vCORE/gi, "核心").replace(/\sSSD \(RAID 10\)/gi, " 固态硬盘 (RAID 10)").replace(/\sSSD/gi, " 硬盘").replace(/\sBANDWIDTH/gi, " 流量").replace(/\sLOCATION/gi, " 数据中心").replace(/BUFFALO(, NY)?/gi, "水牛城").replace(/LOS ANGELES, CA/gi, "洛杉矶").replace(/DALLAS, TX/gi, "达拉斯").replace(/FRANKFURT, DE/gi, "德国").replace(/SEATTLE, WA/gi, "西雅图").replace(/AMSTERDAM, NL/gi, "阿姆斯特丹").replace(/ATLANTA, GA/gi, "亚特兰大").replace(/PISCATAWAY, NJ/gi, "新泽西").replace(/CHICAGO, IL/gi, "芝加哥").replace(/SAN JOSE, CA/gi, "圣何塞").replace(/PHOENIX, AZ/gi, "凤凰城").replace(/ORDER NOW/gi, "立即抢购").replace(/Test IP/gi, "测试 IP").replace(/Test file/gi, "测试文件").replace(/Buy Now/gi, "立即抢购").replace(/Via /gi, "来源：")
	    }
    </script>
</body>
</html>
